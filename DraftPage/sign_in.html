<!doctype html>
<html lang="en">
    <head>
        <title>Sign in</title>
        <link rel="icon" href="icon.svg">
        
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js" integrity="sha384-b5kHyXgcpbZJO/tY9Ul7kGkf1S0CWuKcCD38l8YkeH8z8QjE0GmW1gYU5S9FOnJ0" crossorigin="anonymous"></script>
    
    </head>
    <body style="align-items: center;padding-top: 10px; background-image:url('sign.jpg');background-size:cover;background-position:0% 20%;">
      <h1 class="text-center" style="padding-top: 30px;">
        <svg xmlns="http://www.w3.org/2000/svg" width="42" height="42" fill="currentColor" class="bi bi-calendar4-range" viewBox="0 0 16 16">
          <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM2 2a1 1 0 0 0-1 1v1h14V3a1 1 0 0 0-1-1H2zm13 3H1v9a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V5z"/>
          <path d="M9 7.5a.5.5 0 0 1 .5-.5H15v2H9.5a.5.5 0 0 1-.5-.5v-1zm-2 3v1a.5.5 0 0 1-.5.5H1v-2h5.5a.5.5 0 0 1 .5.5z"/>
        </svg>
        Gathable
      </h1>
      
      <form style="width: 100%;max-width: 450px;padding:40px 60px;margin: auto;border-radius: 40px;background-color:rgba(255, 255, 255, 0.8);">
        <h2 class="text-center mb-2 fw-normal">Sign in</h2>
          
        <div id="alert" class="alert alert-danger mt-2 mb-3" role="alert" style="display:none;"></div>
          
        <label for="userId" class="mb-3">User ID</label>
        <input id="userId" class="form-control mb-3" placeholder="User ID" required>
        <label for="password" class="mb-3">Password</label>
        <input type="password" id="password" class="form-control mb-3" placeholder="Password" required>
        <div class="d-flex justify-content-center mb-3">
        <button class="btn btn-lg btn-success" id="loginb" >Sign in</button>
        </div>
        <p class="small text-center"><a href="#">Forgot password?</a></p>
        <p class="small text-center">Don't have an account yet? <a href="./register.html">Register</a> here</p>
        <p class="mt-5 mb-3 text-muted text-center">&copy; Gathable</p>
      </form>
      <footer class="text-end text-light p-2 mt-sm-3" style="background-color: #2c2c2c;">
		<b>&copy; Gathable</b>
      </footer>
        
        
        <script src="func.js"></script>

        <script>
        <script language = "Javascript">
        checkLogin(function() {
            alert('Already logged in!!);
            window.location.href = "index.html";
        });

        var login = document.getElementById('loginb');

        login.onclick = function() {
            var warningBox = document.getElementById('alert');
            var usernamei = document.getElementById('userID').value;
            var passwordi = document.getElementById('password').value;

            if (usernamei.length == 0) {
                // Check username field empty.
                warningBox.innerHTML = 'Username is empty!';
                warningBox.style.display = 'block';
            } else if (passwordText.length == 0) {
                // Check password field empty.
                warningBox.innerHTML = 'Password is required!';
                warningBox.style.display = 'block';
            } else {
                // Client side check completed.
                login.innerHTML = 'Logging in...';
                login.setAttribute('disabled', '');

                var logininfo = JSON.stringify({
                    username: usernamei,
                    password: passwordi
                });
    
                // POST to the server.
                $.post(serverAddr + '/login', logininfo, function(data, status, xhr) {
                    // Set the cookies.
                    setCookie('uid', JSON.parse(xhr.responseText)['uid']);
                    setCookie('username', usernamei);
            
                    alert('Logged in as user: ' + usernamei + '!');
                    window.location.href = 'index.html';
                }).fail(function(xhr, status, error) {
                    if (xhr.responseText != '') {
                        warningBox.innerHTML = 'Log in failed: ' + JSON.parse(xhr.responseText)['error'] + '.';
                        warningBox.style.display = 'block';
                    } else {
                        warningBox.innerHTML = 'Log in failed with unknown reason, please try again!';
                        warningBox.style.display = 'block';
                    }
    
                    login.innerHTML = 'Log In';
                    login.removeAttribute('disabled');
                });
            }

        };
        
        
        
    </body>
</html>
